import { Notice, MarkdownView, parseYaml } from 'obsidian';
import { DEFAULT_BLOCK_CONFIG } from '../types';
export class BlockManager {
    constructor(app) {
        this.app = app;
    }
    parseBlock(source) {
        const trimmedSource = source.trim();
        const yamlMatch = trimmedSource.match(/^---\n([\s\S]*?)\n---\n([\s\S]*)$/);
        let config = {
            yamlConfig: { ...DEFAULT_BLOCK_CONFIG },
            prompt: trimmedSource,
            hasYaml: false
        };
        if (yamlMatch) {
            config.hasYaml = true;
            try {
                const parsedYaml = parseYaml(yamlMatch[1]);
                config.yamlConfig = { ...DEFAULT_BLOCK_CONFIG, ...parsedYaml };
                config.prompt = yamlMatch[2].trim();
            }
            catch (error) {
                console.error('Error parsing YAML:', error);
                new Notice('YAML parsing error, using default settings');
            }
        }
        return config;
    }
    validateConfig(config) {
        const errors = [];
        const ranges = {
            temperature: [0, 2],
            max_tokens: [1, 20000],
            top_p: [0, 1],
            frequency_penalty: [0, 2],
            presence_penalty: [0, 2],
            num_responses: [1, 20]
        };
        for (const [key, range] of Object.entries(ranges)) {
            if (config[key] !== undefined && (config[key] < range[0] || config[key] > range[1])) {
                errors.push(`${key} must be between ${range[0]} and ${range[1]}`);
            }
        }
        return errors;
    }
    async updateFileBlock(el, ctx, newPrompt, newYaml) {
        const sectionInfo = ctx.getSectionInfo(el);
        if (!sectionInfo)
            throw new Error('Could not get section info');
        const view = this.app.workspace.getActiveViewOfType(MarkdownView);
        if (!view)
            throw new Error('No active markdown view');
        const editor = view.editor;
        const { lineStart, lineEnd } = sectionInfo;
        const updatedBlockContent = newYaml ? `---\n${newYaml}\n---\n${newPrompt}` : newPrompt;
        const startPos = { line: lineStart + 1, ch: 0 };
        const endPos = { line: lineEnd, ch: 0 };
        editor.replaceRange(updatedBlockContent + '\n', startPos, endPos);
        new Notice('Block synced to file');
    }
    generateYamlFromConfig(config) {
        const lines = [];
        const default_config = DEFAULT_BLOCK_CONFIG;
        for (const key in default_config) {
            if (config[key] !== undefined && config[key] !== default_config[key]) {
                const value = config[key];
                if (Array.isArray(value)) {
                    lines.push(`${key}: ${JSON.stringify(value)}`);
                }
                else if (typeof value === 'string') {
                    // Quote strings especially if they contain colons or other potential special chars
                    if (value.includes(':') || value.includes('#') || value === '') {
                        lines.push(`${key}: "${value}"`);
                    }
                    else {
                        lines.push(`${key}: ${value}`);
                    }
                }
                else {
                    lines.push(`${key}: ${value}`);
                }
            }
        }
        return lines.length > 0 ? lines.join('\n') : '';
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQmxvY2tNYW5hZ2VyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiQmxvY2tNYW5hZ2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBTyxNQUFNLEVBQUUsWUFBWSxFQUFnQyxTQUFTLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFDOUYsT0FBTyxFQUF1QixvQkFBb0IsRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUVyRSxNQUFNLE9BQU8sWUFBWTtJQUdyQixZQUFZLEdBQVE7UUFDaEIsSUFBSSxDQUFDLEdBQUcsR0FBRyxHQUFHLENBQUM7SUFDbkIsQ0FBQztJQUVELFVBQVUsQ0FBQyxNQUFjO1FBQ3JCLE1BQU0sYUFBYSxHQUFHLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUNwQyxNQUFNLFNBQVMsR0FBRyxhQUFhLENBQUMsS0FBSyxDQUFDLG1DQUFtQyxDQUFDLENBQUM7UUFFM0UsSUFBSSxNQUFNLEdBQXdCO1lBQzlCLFVBQVUsRUFBRSxFQUFFLEdBQUcsb0JBQW9CLEVBQUU7WUFDdkMsTUFBTSxFQUFFLGFBQWE7WUFDckIsT0FBTyxFQUFFLEtBQUs7U0FDakIsQ0FBQztRQUVGLElBQUksU0FBUyxFQUFFLENBQUM7WUFDWixNQUFNLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQztZQUN0QixJQUFJLENBQUM7Z0JBQ0QsTUFBTSxVQUFVLEdBQUcsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUMzQyxNQUFNLENBQUMsVUFBVSxHQUFHLEVBQUUsR0FBRyxvQkFBb0IsRUFBRSxHQUFHLFVBQVUsRUFBRSxDQUFDO2dCQUMvRCxNQUFNLENBQUMsTUFBTSxHQUFHLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUN4QyxDQUFDO1lBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztnQkFDYixPQUFPLENBQUMsS0FBSyxDQUFDLHFCQUFxQixFQUFFLEtBQUssQ0FBQyxDQUFDO2dCQUM1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QWMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDO2dCQUNuRSxNQUFNLEtBQUssR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7Z0JBQzFCLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO29CQUN2QixLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsR0FBRyxLQUFLLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDO2dCQUNuRCxDQUFDO3FCQUFNLElBQUksT0FBTyxLQUFLLEtBQUssUUFBUSxFQUFFLENBQUM7b0JBQ25DLG1GQUFtRjtvQkFDbkYsSUFBSSxLQUFLLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEtBQUssQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLElBQUksS0FBSyxLQUFLLEVBQUUsRUFBRSxDQUFDO3dCQUM3RCxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsR0FBRyxNQUFNLEtBQUssR0FBRyxDQUFDLENBQUM7b0JBQ3JDLENBQUM7eUJBQU0sQ0FBQzt3QkFDSixLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsR0FBRyxLQUFLLEtBQUssRUFBRSxDQUFDLENBQUM7b0JBQ25DLENBQUM7Z0JBQ0wsQ0FBQztxQkFBTSxDQUFDO29CQUNKLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxHQUFHLEtBQUssS0FBSyxFQUFFLENBQUMsQ0FBQztnQkFDbkMsQ0FBQztZQUNMLENBQUM7UUFDTCxDQUFDO1FBRUQsT0FBTyxLQUFLLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO0lBQ3BELENBQUM7Q0FDSiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcCwgTm90aWNlLCBNYXJrZG93blZpZXcsIE1hcmtkb3duUG9zdFByb2Nlc3NvckNvbnRleHQsIHBhcnNlWWFtbCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IE9sbGFtYUJsb2NrU2V0dGluZ3MsIERFRkFVTFRfQkxPQ0tfQ09ORklHIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgQmxvY2tNYW5hZ2VyIHtcbiAgICBwcml2YXRlIGFwcDogQXBwO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHApIHtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgfVxuXG4gICAgcGFyc2VCbG9jayhzb3VyY2U6IHN0cmluZyk6IE9sbGFtYUJsb2NrU2V0dGluZ3Mge1xuICAgICAgICBjb25zdCB0cmltbWVkU291cmNlID0gc291cmNlLnRyaW0oKTtcbiAgICAgICAgY29uc3QgeWFtbE1hdGNoID0gdHJpbW1lZFNvdXJjZS5tYXRjaCgvXi0tLVxcbihbXFxzXFxTXSo/KVxcbi0tLVxcbihbXFxzXFxTXSopJC8pO1xuXG4gICAgICAgIGxldCBjb25maWc6IE9sbGFtYUJsb2NrU2V0dGluZ3MgPSB7XG4gICAgICAgICAgICB5YW1sQ29uZmlnOiB7IC4uLkRFRkFVTFRfQkxPQ0tfQ09ORklHIH0sXG4gICAgICAgICAgICBwcm9tcHQ6IHRyaW1tZWRTb3VyY2UsXG4gICAgICAgICAgICBoYXNZYW1sOiBmYWxzZVxuICAgICAgICB9O1xuXG4gICAgICAgIGlmICh5YW1sTWF0Y2gpIHtcbiAgICAgICAgICAgIGNvbmZpZy5oYXNZYW1sID0gdHJ1ZTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGFyc2VkWWFtbCA9IHBhcnNlWWFtbCh5YW1sTWF0Y2hbMV0pO1xuICAgICAgICAgICAgICAgIGNvbmZpZy55YW1sQ29uZmlnID0geyAuLi5ERUZBVUxUX0JMT0NLX0NPTkZJRywgLi4ucGFyc2VkWWFtbCB9O1xuICAgICAgICAgICAgICAgIGNvbmZpZy5wcm9tcHQgPSB5YW1sTWF0Y2hbMl0udHJpbSgpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwYXJzaW5nIFlBTUw6JywgZXJyb3IpO1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ1lBTUwgcGFyc2luZyBlcnJvciwgdXNpbmcgZGVmYXVsdCBzZXR0aW5ncycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNvbmZpZztcbiAgICB9XG5cbiAgICB2YWxpZGF0ZUNvbmZpZyhjb25maWc6IGFueSk6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3QgZXJyb3JzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBjb25zdCByYW5nZXMgPSB7XG4gICAgICAgICAgICB0ZW1wZXJhdHVyZTogWzAsIDJdLFxuICAgICAgICAgICAgbWF4X3Rva2VuczogWzEsIDIwMDAwXSxcbiAgICAgICAgICAgIHRvcF9wOiBbMCwgMV0sXG4gICAgICAgICAgICBmcmVxdWVuY3lfcGVuYWx0eTogWzAsIDJdLFxuICAgICAgICAgICAgcHJlc2VuY2VfcGVuYWx0eTogWzAsIDJdLFxuICAgICAgICAgICAgbnVtX3Jlc3BvbnNlczogWzEsIDIwXVxuICAgICAgICB9O1xuXG4gICAgICAgIGZvciAoY29uc3QgW2tleSwgcmFuZ2VdIG9mIE9iamVjdC5lbnRyaWVzKHJhbmdlcykpIHtcbiAgICAgICAgICAgIGlmIChjb25maWdba2V5XSAhPT0gdW5kZWZpbmVkICYmIChjb25maWdba2V5XSA8IHJhbmdlWzBdIHx8IGNvbmZpZ1trZXldID4gcmFuZ2VbMV0pKSB7XG4gICAgICAgICAgICAgICAgZXJyb3JzLnB1c2goYCR7a2V5fSBtdXN0IGJlIGJldHdlZW4gJHtyYW5nZVswXX0gYW5kICR7cmFuZ2VbMV19YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZXJyb3JzO1xuICAgIH1cblxuICAgIGFzeW5jIHVwZGF0ZUZpbGVCbG9jayhlbDogSFRNTEVsZW1lbnQsIGN0eDogTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCwgbmV3UHJvbXB0OiBzdHJpbmcsIG5ld1lhbWw6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBzZWN0aW9uSW5mbyA9IGN0eC5nZXRTZWN0aW9uSW5mbyhlbCk7XG4gICAgICAgIGlmICghc2VjdGlvbkluZm8pIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGdldCBzZWN0aW9uIGluZm8nKTtcblxuICAgICAgICBjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgaWYgKCF2aWV3KSB0aHJvdyBuZXcgRXJyb3IoJ05vIGFjdGl2ZSBtYXJrZG93biB2aWV3Jyk7XG5cbiAgICAgICAgY29uc3QgZWRpdG9yID0gdmlldy5lZGl0b3I7XG4gICAgICAgIGNvbnN0IHsgbGluZVN0YXJ0LCBsaW5lRW5kIH0gPSBzZWN0aW9uSW5mbztcblxuICAgICAgICBjb25zdCB1cGRhdGVkQmxvY2tDb250ZW50ID0gbmV3WWFtbCA/IGAtLS1cXG4ke25ld1lhbWx9XFxuLS0tXFxuJHtuZXdQcm9tcHR9YCA6IG5ld1Byb21wdDtcblxuICAgICAgICBjb25zdCBzdGFydFBvcyA9IHsgbGluZTogbGluZVN0YXJ0ICsgMSwgY2g6IDAgfTtcbiAgICAgICAgY29uc3QgZW5kUG9zID0geyBsaW5lOiBsaW5lRW5kLCBjaDogMCB9O1xuXG4gICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UodXBkYXRlZEJsb2NrQ29udGVudCArICdcXG4nLCBzdGFydFBvcywgZW5kUG9zKTtcbiAgICAgICAgbmV3IE5vdGljZSgnQmxvY2sgc3luY2VkIHRvIGZpbGUnKTtcbiAgICB9XG5cbiAgICBnZW5lcmF0ZVlhbWxGcm9tQ29uZmlnKGNvbmZpZzogYW55KTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgbGluZXM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGNvbnN0IGRlZmF1bHRfY29uZmlnOiBhbnkgPSBERUZBVUxUX0JMT0NLX0NPTkZJRztcblxuICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBkZWZhdWx0X2NvbmZpZykge1xuICAgICAgICAgICAgaWYgKGNvbmZpZ1trZXldICE9PSB1bmRlZmluZWQgJiYgY29uZmlnW2tleV0gIT09IGRlZmF1bHRfY29uZmlnW2tleV0pIHtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGNvbmZpZ1trZXldO1xuICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICBsaW5lcy5wdXNoKGAke2tleX06ICR7SlNPTi5zdHJpbmdpZnkodmFsdWUpfWApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICAvLyBRdW90ZSBzdHJpbmdzIGVzcGVjaWFsbHkgaWYgdGhleSBjb250YWluIGNvbG9ucyBvciBvdGhlciBwb3RlbnRpYWwgc3BlY2lhbCBjaGFyc1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUuaW5jbHVkZXMoJzonKSB8fCB2YWx1ZS5pbmNsdWRlcygnIycpIHx8IHZhbHVlID09PSAnJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGluZXMucHVzaChgJHtrZXl9OiBcIiR7dmFsdWV9XCJgKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVzLnB1c2goYCR7a2V5fTogJHt2YWx1ZX1gKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmVzLnB1c2goYCR7a2V5fTogJHt2YWx1ZX1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbGluZXMubGVuZ3RoID4gMCA/IGxpbmVzLmpvaW4oJ1xcbicpIDogJyc7XG4gICAgfVxufVxuIl19